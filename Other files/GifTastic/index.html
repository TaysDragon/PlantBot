<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>PlantBot</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="assets/css/reset.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sHa384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="assets/css/style.css">
</head>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- <script type="text/javascript" src="assets/javascript/giphy.js"></script> -->

<body>
    <div class="container, row">
        <h1>Plant Search</h1>
        <!-- Rendered buttons will get dumped Here  -->
        <div id="buttons-view"></div>
        <form id="plant-form">
            <label for="plantAdd">Add a plant</label>
            <input type="text" id="plantAdd">
            <br>
            <!-- Button triggers new plant to be added -->
            <input id="add-plant" type="submit" value="Add a plant">
        </form>
        <!-- Show plant picture -->
        <div id="plant-view"></div>
        <!-- <img src="http://media1.giphy.com/media/3o85xkQpyMlnBkpB9C/200_s.gif" data-still="http://media1.giphy.com/media/3o85xkQpyMlnBkpB9C/200_s.gif" data-animate="http://media1.giphy.com/media/3o85xkQpyMlnBkpB9C/200.gif" data-state="still" class="gif"> -->
        
</div>

        <footer>
            &copy; Copyright 2017 Sharon Oud
        </footer>
        <script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>
        <script type="text/javascript">
        // This is what plant we search
        


        // Initial array of plants
        var plants = ["Mango", "Banana", "Sapodilla"];


        // displayMovieInfo function re-renders the HTML to display the appropriate content
        function displayPlantInfo() {

            var plant = $(this).attr("data-name");
            var queryURL = "http://tropicalfruitandveg.com/api/tfvjsonapi.php?tfvitem=" + plant;

            // Creates AJAX call for the specific plant button being clicked
            $.ajax({
                url: queryURL,
                method: "GET",
                dataType: "jsonp",
                crossOrigin:true
            }).done(function(response) {
console.log("I got a response");

                // Log the queryURL
                console.log(queryURL);

                // Log the resulting object
                console.log(response.results[0]);
                // storing the data from the AJAX request in the results variable
                var results = response.results;

                for (var i = 0; i < results.length; i++) {

                    // Creating a div to hold plant
                    var plantDiv = $("<div class='gify'>");

                    

                    // Retrieving the URL for the image
                    var imgURL = response.imageurl;

                    // Creating an element to hold the image
                    var image = $("<img>");

                    image.attr("src", results[i].imageurl).addClass("gif");

                    // Appending the image
                    plantDiv.append(image);

                    // Storing the botanicalName data and Creating an element to have the botanicalName displayed
                    var botanicalName = $("<p>").text("botanicalName: " + results[i].botname);

                    // Displaying the botanicalName
                    plantDiv.append(botanicalName);

                    // Putting the entire movie above the previous movies
                    $("#plant-view").prepend(plantDiv);                
        }
    });
        }

        // Function for displaying plant data
        function renderButtons() {

            // Deletes the plants prior to adding new plants
            // (this is necessary otherwise you will have repeat buttons)
            $("#buttons-view").empty();

            // Loops through the array of plants
            for (var i = 0; i < plants.length; i++) {

                // Then dynamicaly generates buttons for each plant in the array
                // This code $("<button>") is all jQuery needs to create the beginning and end tag. (<button></button>)
                var a = $("<button>");
                // Adds a class of plant to our button
                a.addClass("plant");
                // Added a data-attribute
                a.attr("data-name", plants[i]);
                // Provided the initial button text
                a.text(plants[i]);
                // Added the button to the buttons-view div
                $("#buttons-view").append(a);
            }
        }

        // This function handles events where the add plant button is clicked
        $("#add-plant").on("click", function(event) {
            event.preventDefault();
            // This line of code will grab the input from the textbox
            var plantNew = $("#plantAdd").val().trim();

            // The plant from the textbox is then added to our array
            plants.push(plantNew);

            // Calling renderButtons which handles the processing of our plant array
            renderButtons();

        });

        // Adding click event listeners to all elements with a class of "plant"
        $(document).on("click", ".plant", displayPlantInfo);

        // Calling the renderButtons function to display the intial buttons
        renderButtons();





</script>
        
    
</body>
</html>

